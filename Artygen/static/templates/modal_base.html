<!-- Modal Template Réutilisable -->
<!-- 
    Variables requises:
    - modal_id: ID unique du modal
    - modal_title: Titre du modal
    - modal_icon: Classe de l'icône (ex: fas fa-plus-circle)
    - form_action: URL d'action du formulaire
    - form_method: Méthode du formulaire (POST par défaut)
    - submit_text: Texte du bouton de soumission
    - submit_icon: Icône du bouton de soumission
-->

<div class="modal fade custom-modal" id="{{ modal_id }}" tabindex="-1" role="dialog" aria-labelledby="{{ modal_id }}Label" aria-hidden="true">
    <div class="modal-dialog {% if modal_size %}modal-{{ modal_size }}{% endif %}" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="{{ modal_id }}Label">
                    {% if modal_icon %}<i class="{{ modal_icon }}"></i>{% endif %}
                    {{ modal_title }}
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: white; opacity: 1;">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="{{ form_method|default:'POST' }}" action="{{ form_action }}" {% if form_enctype %}enctype="{{ form_enctype }}"{% endif %} data-validate="true" onsubmit="handleFormSubmit(event, this)">
                {% csrf_token %}
                <div class="modal-body">
                    {% block modal_body %}
                    <!-- Contenu du formulaire ici -->
                    {% endblock %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-custom-secondary" data-dismiss="modal">
                        <i class="fas fa-times"></i> Annuler
                    </button>
                    <button type="submit" class="btn btn-custom-primary" id="{{ modal_id }}SubmitBtn">
                        {% if submit_icon %}<i class="{{ submit_icon }}"></i>{% endif %}
                        {{ submit_text|default:'Enregistrer' }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
function handleFormSubmit(event, form) {
    const submitBtn = form.querySelector('button[type="submit"]');
    submitBtn.classList.add('btn-loading');
    submitBtn.disabled = true;
    
    // Le formulaire se soumettra normalement
    // La restauration du bouton se fera au rechargement de la page
}
</script>
